<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–í–∞—à –†–µ–∑—É–ª—å—Ç–∞—Ç –¢–µ—Å—Ç–∞</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h1>

    <div class="cube-container">
        <div id="result-cube" class="cube">
            <div class="face front">
                <h2>–ë–∞–ª–ª—ã</h2>
                <p>{{ score }} –∏–∑ {{ total }}</p>
            </div>
            <div class="face back">
                <h2>–ü—Ä–æ—Ü–µ–Ω—Ç</h2>
                <p>{{ percentage }}%</p>
            </div>
            <div class="face right">
                <h2>–í–µ—Ä–Ω–æ</h2>
                <p>{{ score }} –æ—Ç–≤–µ—Ç–æ–≤</p>
            </div>
            <div class="face left">
                <h2>–ù–µ–≤–µ—Ä–Ω–æ</h2>
                <p>{{ total - score }} –æ—Ç–≤–µ—Ç–æ–≤</p>
            </div>

            <div class="face top">
                <h2>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</h2>
                <button id="open-modal-btn" class="rec-button">
                    –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å
                </button>
            </div>

            <div class="face bottom">
                <h2>–î–µ—Ä–∑–∞–π!</h2>
                <p>–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –≤—Ä–∞—â–∞—Ç—å</p>
            </div>
        </div>
    </div>

    <a href="{{ url_for('index') }}" class="back-link">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É —Ç–µ—Å—Ç–æ–≤</a>

    <div id="recommendation-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é</h3>
            <p>{{ recommendation }}</p>
        </div>
    </div>

   <script>
        // –ö–æ–¥ –≤—Ä–∞—â–µ–Ω–∏—è –∫—É–±–∏–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        const cube = document.getElementById('result-cube');
        let rotationX = 0;
        let rotationY = 0;
        let isDragging = false;
        let previousMouseX = 0;
        let previousMouseY = 0;
        const sensitivity = 0.5;

        // 1. –ù–ê–ß–ê–õ–û –í–†–ê–©–ï–ù–ò–Ø (mousedown)
        cube.addEventListener('mousedown', (e) => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –Ω–∞–∂–∞–ª–∏ –ª–∏ –º—ã –Ω–∞ –∫–Ω–æ–ø–∫—É –≤–Ω—É—Ç—Ä–∏ –∫—É–±–∞
            if (e.target.closest('#open-modal-btn')) return;

            e.preventDefault();
            isDragging = true;
            previousMouseX = e.clientX;
            previousMouseY = e.clientY;
            cube.style.transition = 'none';
        });

        // 2. –í–†–ê–©–ï–ù–ò–ï (mousemove) - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;

            const deltaX = e.clientX - previousMouseX;
            const deltaY = e.clientY - previousMouseY;

            rotationY += deltaX * sensitivity;
            rotationX -= deltaY * sensitivity;

            cube.style.transform = `rotateX(${rotationX}deg) rotateY(${rotationY}deg)`;

            previousMouseX = e.clientX;
            previousMouseY = e.clientY;
        });

        // 3. –ö–û–ù–ï–¶ –í–†–ê–©–ï–ù–ò–Ø (mouseup) - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        document.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
                cube.style.transition = 'transform 0.8s ease-in-out';
            }
        });

        document.addEventListener('mouseleave', () => {
            if (isDragging) {
                isDragging = false;
                cube.style.transition = 'transform 0.8s ease-in-out';
            }
        });

        // ‚≠ê –ù–û–í–´–ô –ö–û–î: –õ–û–ì–ò–ö–ê –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê ‚≠ê
        const modal = document.getElementById('recommendation-modal');
        const openBtn = document.getElementById('open-modal-btn');
        const closeBtn = document.querySelector('.close-btn');

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        openBtn.onclick = function() {
            modal.style.display = 'block';
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ –∫—Ä–µ—Å—Ç–∏–∫—É
        closeBtn.onclick = function() {
            modal.style.display = 'none';
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –æ–∫–Ω–∞
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>

</body>
</html>